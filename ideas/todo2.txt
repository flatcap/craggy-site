db.sh check mysql for errors
check for empty files and delete them

add_climb
        success = del climb from table
        fail don't

add_route
        success = del routes from table
        fail don't

del_route
        success = del routes from table
        fail don't

edit_route
        success update table's "original" values
        fail don't

hide buttons when no table?

x_error area for completion - use it or lose it
likewise "matches" div

&nbsp; between buttons!

button order

standardise *_work.php

don't send <id>U123</id>

paste into field doesn't activate on keyup/down/press => no active button

add tablesorter to edit table?

db.sh check mysql for errors, or empty files & delete them

can't enter a features only route without a setter and date

ctrl-s -> save?

test with db turned off
test with js turned off

add climb count to add climbs + downclimbs

reset on all dialogs

GET -> POST

all transfers in xml

empty fields, auto complete
default values!
tie in with reset button

multiple climb problem
need to uniquely identify them

check, that if unsorted (by tablesorter), panels are in seq order

---------------------

rather than
        x .= "html"
        x .= "html"
        innerHtml = x;
create table
        x .= "table..."
then
        get tbody
tb.addChild (tr), td, input?

OR

all html -> innerHtml
then iterate through all inputs and attach callbacks

-------------------

can we transform
        php     <->     xml     <->     html
        xml             dom             dom
using xsl?

if I have an error message column in the table, things will get pretty wide

I don't need row numbers

give each row a uniq id (store in tr for convenience)

keep successful routes: message "success" in green

if using xslt, do all the tags *have* to exist?
will a missing tag leave a gap in my table?
probably not.  select value-of will return empty

tr.success -> set of <td>value</td>
tr.failure -> set of <td>value</td>

xslt only needs to assemble/disassemble <table> not entire page

php side, add ids to xml colour_id, grade_id, etc

aretes on 85, 86, most of the 80s in fact

db script db [pull,compare,etc] [options]

add_climbs
        3 or(d) ->

[X] id, panel, colour, grade, type | success, diff, notes | date
        V_ROUTES                        RATING              GIVEN
or nice values together
notes prepend original "; "

------------------------------

use autocompletion on the "add climbs" dialog:
34 all(d)<space> -> 34 White(d), Blue(d), Pink(d)

type "done" or "commit" in entry box to commit all changes
"save"?  other commands?

ctrl-s from anywhere to save?

select historic routes as of a certin date
w.r.t. date_set & date_end

-------------------------------

colours list in apc_cache ['table_colour']
colour_lookup store as table_colour_1 or _lookup
before using lookup, do cache_get on colour
cache get colour fails (expired), does db_select
before db_select invalidate table_colour* in cache (things dependent on colour)
s/table/cache/g

invalidate
        get list of keys in cache
        delete matches

what if if depends on several tables?

---------------------------------

route:
        id, row, panel, colour, grade, setter, date, notes, message

if all successful, green box *12 new routes created* link to routes table
http://craggy.russon.org/routes.php?highlight=34-36,38

some successful, orange box *4 new routes created*, however
list of errors
Num 4:
        msg1...
        msg2...
Num 6:
        msg1...
        etc

xml from add_work
        ok      <colour>red</colour>
        fail    <grade type='invalid'>6s</grade>

clear successful routes?

on failed routes, reaplce table data with reply from php
sync would be good, but just replacing the table would be simpler

how should I renumber the rows?  In route_data they correspond to the index?
change the id column heading to Row -> clear success, renumber rows, display warnings

OR

leave successful routes in place
        sync data / rebuild table
        success routes are RO   }
        failed routes are RW    } colour difference?

on resend only send routes that haven't been committed (keep track in the <tr>)
php needs to maintain the row number

-----------------------------------

do auto-complete / validation using xml

-----------------------------------

get_climbs
        climber_id
        fields
        flags
        where

fields
        route_id
        panel_id / panel
        colour_id / colour
        grade_id / grade
        setter_id / setter
        notes
        date_set
        date_end
        climb_type_id / climb_type
        onsight (generated)

flags - maybe skip this and work on result list
        process_best
        process binary
        process_date
        etc

default, order by panel_seq, grade, colour, date_climbed

----------------------------------

finite state machine for each dialogs (dotty)

climbs
        get routes
        get ratings for climber
        merge / join db -> lots of null

row | panel, colour, grade | diff, nice, onsight | notes | climb_info

climb_info => bests
        latest date             }
        highest success         } generated, move to rating (best)?
        count of climbs         }

downclimbs
	select routes + ratings + climbs (best)

select current climbs / routes -> date_end is null, active is not null - irrelevant if joining

UI
	Columns (drop list) config
		[X] Notes
		[X] Difficulty
		[X] Success
		etc
	
fix php to work in deeper dirs
/index.php        OK
/craggy/index.php FAIL

fpdf on russon.org

allow update on russon.org (only in admin)

db control
	craggy user can read from route tables
	admin user can read/write from/to route tables
	rich user can read/write climb tables, read from route tables

route tables
	climb_type
	colour
	data
	grade
	panel
	route
	setter

climb tables
	climb
	climber
	difficulty
	rating
	success

